---
import BaseLayout from '../layouts/BaseLayout.astro';
import SectionHeader from '../components/SectionHeader.astro';
import Card from '../components/Card.astro';
import TagList from '../components/TagList.astro';
import ProofBlock from '../components/ProofBlock.astro';
import TwoOptionCTA from '../components/TwoOptionCTA.astro';
import { loadSiteContent } from '../lib/content';
import CardGrid from '../components/CardGrid.astro';
import TwoColumn from '../components/TwoColumn.astro';

const { profile, games, modules } = await loadSiteContent();
const featuredGames = games.slice(0, 3);
const featuredModules = modules.slice(0, 3);
const proofBullets = profile.proof_selected.slice(0, 4).flatMap((entry) => entry.proof);
---
<BaseLayout title={`Home - ${profile.name}`} description="Proof-first portfolio and open source AI labs">
  <SectionHeader
    title="Built for teams building governed AI."
    subtitle="I share proof-first patterns through demos, modules, and community routes."
  />
  <div class="page-shell">
    <Card>
      <p>Build, measure, and ship with evidence.</p>
      <div style="display:flex; gap:0.75rem; flex-wrap:wrap; margin-top:0.75rem;">
        <a class="button" href="/labs">Labs</a>
        <a class="button" href="/learn">Learn</a>
        <a class="button" href="/book">Book</a>
      </div>
    </Card>

    <ProofBlock claim="Oscar's work is built from measurable outcomes." proof={proofBullets} nextStep="Browse featured labs" nextHref="/labs" />

    <Card>
      <h2>Featured labs</h2>
      <CardGrid>
        {featuredGames.map((game) => (
          <article class="card">
            <h3>{game.title}</h3>
            <p style="margin-top:0.5rem;">{game.tagline}</p>
            <TagList tags={game.concepts} />
            <div style="margin-top:0.8rem; display:flex; gap:0.5rem;">
              <a class="button" href={`/labs/${game.id}`}>Open</a>
            </div>
          </article>
        ))}
      </CardGrid>
    </Card>

    <Card>
      <h2>Featured learning</h2>
      <CardGrid>
        {featuredModules.map((module) => (
          <article class="card">
            <h3>{module.title}</h3>
            <p class="text-small" style="margin-top:0.5rem;">{module.level} - {module.time}</p>
            <TagList tags={module.topics} />
            <a class="button" style="margin-top:0.7rem;" href={module.cta.href}>{module.cta.label}</a>
          </article>
        ))}
      </CardGrid>
    </Card>

    <TwoOptionCTA
      title="Choose your path"
      options={[
        { title: 'Ship a small win', body: 'Build a measurable demo and share proof.', href: '/learn' },
        { title: 'Contribute governance', body: 'Review a risk template and join a playbook loop.', href: '/join' },
      ]}
    />

    <TwoColumn>
      <Card slot="primary">
        <h2>Bio snapshot</h2>
        <p style="margin-top:0.5rem;">{profile.summary[0]}</p>
        <p class="text-small" style="margin-top:0.5rem;">{profile.summary[1]}</p>
      </Card>
      <Card slot="secondary">
        <h2>Proof highlights</h2>
        <ul style="margin-top:0.5rem;">
          {proofBullets.map((item) => <li>{item}</li>)}
        </ul>
      </Card>
    </TwoColumn>
  </div>
</BaseLayout>
